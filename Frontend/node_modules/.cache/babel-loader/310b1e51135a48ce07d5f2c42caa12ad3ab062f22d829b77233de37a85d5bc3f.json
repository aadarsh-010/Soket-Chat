{"ast":null,"code":"var _jsxFileName = \"E:\\\\Soket-chat\\\\Soket-Chat\\\\Frontend\\\\src\\\\components\\\\Chat\\\\preview\\\\files\\\\HandleAndSend.jsx\",\n  _s = $RefreshSig$();\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Add from \"./Add\";\nimport { CloseIcon, SendIcon } from \"../../../../svg\";\nimport { uploadFiles } from \"../../../../utils/upload\";\nimport { useState } from \"react\";\nimport { removeFileFromFiles, sendMessage } from \"../../../../features/chatSlice\";\nimport SocketContext from \"../../../../context/SocketContext\";\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport VideoThumbnail from \"react-video-thumbnail\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction HandleAndSend(_ref) {\n  _s();\n  let {\n    activeIndex,\n    setActiveIndex,\n    message,\n    socket\n  } = _ref;\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const {\n    files,\n    activeConversation\n  } = useSelector(state => state.chat);\n  const {\n    user\n  } = useSelector(state => state.user);\n  const {\n    token\n  } = user;\n  //send message handler\n  const sendMessageHandler = async e => {\n    e.preventDefault();\n    setLoading(true);\n    //uplaod files first\n    const uploaded_files = await uploadFiles(files);\n    //send the message\n    const values = {\n      token,\n      message,\n      convo_id: activeConversation._id,\n      files: uploaded_files.length > 0 ? uploaded_files : []\n    };\n    let newMsg = await dispatch(sendMessage(values));\n    socket.emit(\"send message\", newMsg.payload);\n    setLoading(false);\n  };\n  //Handle remove file\n  const handleRemoveFile = index => {\n    dispatch(removeFileFromFiles(index));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-[97%] flex items-center justify-between mt-2 border-t dark:border-dark_border_2\",\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-x-2\",\n      children: [files.map((file, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `fileThumbnail relative w-14 h-14 border dark:border-white mt-2 rounded-md overflow-hidden cursor-pointer\n            ${activeIndex === i ? \"border-[3px] !border-green_1\" : \"\"}\n            `,\n        onClick: () => setActiveIndex(i),\n        children: [file.type === \"IMAGE\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: file.fileData,\n          alt: \"\",\n          className: \"w-full h-full object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 15\n        }, this) : file.type === \"VIDEO\" ? /*#__PURE__*/_jsxDEV(VideoThumbnail, {\n          videoUrl: file.fileData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `../../../../images/file/${file.type}.png`,\n          alt: \"\",\n          className: \"w-8 h-10 mt-1.5 ml-2.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"removeFileIcon hidden\",\n          onClick: () => handleRemoveFile(i),\n          children: /*#__PURE__*/_jsxDEV(CloseIcon, {\n            className: \"dark:fill-white absolute right-0 top-0 w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 13\n        }, this)]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(Add, {\n        setActiveIndex: setActiveIndex\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-green_1 w-16 h-16 mt-2 rounded-full flex items-center justify-center cursor-pointer\",\n      onClick: e => sendMessageHandler(e),\n      children: loading ? /*#__PURE__*/_jsxDEV(ClipLoader, {\n        color: \"#E9EDEF\",\n        size: 25\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(SendIcon, {\n        className: \"fill-white\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this);\n}\n_s(HandleAndSend, \"wGm5yQTTP9m7ktddjTYrkl6PWtw=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n_c = HandleAndSend;\nconst HandleAndSendWithContext = props => /*#__PURE__*/_jsxDEV(SocketContext.Consumer, {\n  children: socket => /*#__PURE__*/_jsxDEV(HandleAndSend, {\n    ...props,\n    socket: socket\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 18\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 98,\n  columnNumber: 3\n}, this);\n_c2 = HandleAndSendWithContext;\nexport default HandleAndSendWithContext;\nvar _c, _c2;\n$RefreshReg$(_c, \"HandleAndSend\");\n$RefreshReg$(_c2, \"HandleAndSendWithContext\");","map":{"version":3,"names":["useDispatch","useSelector","Add","CloseIcon","SendIcon","uploadFiles","useState","removeFileFromFiles","sendMessage","SocketContext","ClipLoader","VideoThumbnail","jsxDEV","_jsxDEV","HandleAndSend","_ref","_s","activeIndex","setActiveIndex","message","socket","dispatch","loading","setLoading","files","activeConversation","state","chat","user","token","sendMessageHandler","e","preventDefault","uploaded_files","values","convo_id","_id","length","newMsg","emit","payload","handleRemoveFile","index","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","file","i","onClick","type","src","fileData","alt","videoUrl","color","size","_c","HandleAndSendWithContext","props","Consumer","_c2","$RefreshReg$"],"sources":["E:/Soket-chat/Soket-Chat/Frontend/src/components/Chat/preview/files/HandleAndSend.jsx"],"sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\nimport Add from \"./Add\";\nimport { CloseIcon, SendIcon } from \"../../../../svg\";\nimport { uploadFiles } from \"../../../../utils/upload\";\nimport { useState } from \"react\";\nimport {\n  removeFileFromFiles,\n  sendMessage,\n} from \"../../../../features/chatSlice\";\nimport SocketContext from \"../../../../context/SocketContext\";\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport VideoThumbnail from \"react-video-thumbnail\";\n\nfunction HandleAndSend({ activeIndex, setActiveIndex, message, socket }) {\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const { files, activeConversation } = useSelector((state) => state.chat);\n  const { user } = useSelector((state) => state.user);\n  const { token } = user;\n  //send message handler\n  const sendMessageHandler = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    //uplaod files first\n    const uploaded_files = await uploadFiles(files);\n    //send the message\n    const values = {\n      token,\n      message,\n      convo_id: activeConversation._id,\n      files: uploaded_files.length > 0 ? uploaded_files : [],\n    };\n    let newMsg = await dispatch(sendMessage(values));\n    socket.emit(\"send message\", newMsg.payload);\n    setLoading(false);\n  };\n  //Handle remove file\n  const handleRemoveFile = (index) => {\n    dispatch(removeFileFromFiles(index));\n  };\n  return (\n    <div className=\"w-[97%] flex items-center justify-between mt-2 border-t dark:border-dark_border_2\">\n      {/*Empty*/}\n      <span></span>\n      {/*List files*/}\n      <div className=\"flex items-center gap-x-2\">\n        {files.map((file, i) => (\n          <div\n            key={i}\n            className={`fileThumbnail relative w-14 h-14 border dark:border-white mt-2 rounded-md overflow-hidden cursor-pointer\n            ${activeIndex === i ? \"border-[3px] !border-green_1\" : \"\"}\n            `}\n            onClick={() => setActiveIndex(i)}\n          >\n            {file.type === \"IMAGE\" ? (\n              <img\n                src={file.fileData}\n                alt=\"\"\n                className=\"w-full h-full object-cover\"\n              />\n            ) : file.type === \"VIDEO\" ? (\n              <VideoThumbnail videoUrl={file.fileData} />\n            ) : (\n              <img\n                src={`../../../../images/file/${file.type}.png`}\n                alt=\"\"\n                className=\"w-8 h-10 mt-1.5 ml-2.5\"\n              />\n            )}\n            {/*Remove file icon*/}\n            <div\n              className=\"removeFileIcon hidden\"\n              onClick={() => handleRemoveFile(i)}\n            >\n              <CloseIcon className=\"dark:fill-white absolute right-0 top-0 w-4 h-4\" />\n            </div>\n          </div>\n        ))}\n        {/* Add another file */}\n        <Add setActiveIndex={setActiveIndex} />\n      </div>\n      {/*Send button*/}\n      <div\n        className=\"bg-green_1 w-16 h-16 mt-2 rounded-full flex items-center justify-center cursor-pointer\"\n        onClick={(e) => sendMessageHandler(e)}\n      >\n        {loading ? (\n          <ClipLoader color=\"#E9EDEF\" size={25} />\n        ) : (\n          <SendIcon className=\"fill-white\" />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst HandleAndSendWithContext = (props) => (\n  <SocketContext.Consumer>\n    {(socket) => <HandleAndSend {...props} socket={socket} />}\n  </SocketContext.Consumer>\n);\nexport default HandleAndSendWithContext;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}